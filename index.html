<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nuno · Analytics Playground</title>

  <!-- PyScript (Python in the browser) -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
  <py-config>
    packages = ["numpy", "matplotlib"]
  </py-config>

  <!-- Plotly: explicit v2.x -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

  <style>
    :root{
      --bg:#0f172a; --panel:#0b1226; --muted:#94a3b8; --text:#e5e7eb;
      --brand:#06b6d4; --accent:#38bdf8; --card:#0b1226; --shadow: 0 10px 30px rgba(2,8,23,.28);
      --radius: 18px;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 600px at 10% -10%, rgba(56,189,248,.10), transparent 50%),
                  radial-gradient(1200px 600px at 110% 20%, rgba(34,211,238,.10), transparent 50%),
                  var(--bg);
      color:var(--text); display:flex; min-height:100vh;
    }

    /* Sidebar */
    .sidebar{width:260px; background: linear-gradient(180deg, rgba(2,8,23,.7), rgba(2,8,23,.25)), var(--panel);
      border-right:1px solid rgba(148,163,184,.12); padding:20px 18px; position:sticky; top:0; height:100vh;}
    .logo{display:flex; align-items:center; gap:12px; margin-bottom:14px;}
    .logo svg{width:34px;height:34px; filter:drop-shadow(0 4px 10px rgba(34,211,238,.35))}
    .logo h1{font-size:18px; margin:0; letter-spacing:.3px}
    .subtle{color:var(--muted); font-size:13px; margin:0 0 22px}
    .side-group{margin-top:18px}
    .side-title{font-size:12px; text-transform:uppercase; letter-spacing:.16em; color:#86a2c2; margin:10px 10px}
    .side-link{display:flex; align-items:center; gap:10px; padding:10px 12px; margin:6px 6px; border-radius:12px;
      color:var(--text); text-decoration:none; border:1px solid rgba(148,163,184,.10);
      background:linear-gradient(180deg, rgba(148,163,184,.06), rgba(148,163,184,.02));
      transition:transform .08s ease, border-color .2s ease, background .2s ease;}
    .side-link:hover{transform:translateY(-1px); border-color:rgba(34,211,238,.35)}
    .pill{margin-left:auto; font-size:11px; color:#9bdff3; background:rgba(34,211,238,.15); padding:2px 8px; border-radius:999px; border:1px solid rgba(34,211,238,.25)}

    /* Main */
    .container{flex:1; display:flex; flex-direction:column}
    .topbar{position:sticky; top:0; z-index:10; backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(2,8,23,.65), rgba(2,8,23,.35));
      border-bottom:1px solid rgba(148,163,184,.12);}
    .top-wrap{display:flex; align-items:center; justify-content:space-between; padding:12px 20px}
    .menu{display:flex; gap:10px; padding:8px; border-radius:999px; background:rgba(148,163,184,.10); border:1px solid rgba(148,163,184,.16)}
    .menu button{background:transparent; border:0; color:var(--text); padding:10px 14px; border-radius:999px; font-weight:600; cursor:pointer; font-size:14px;}
    .menu button.active{background:linear-gradient(180deg, rgba(34,211,238,.22), rgba(34,211,238,.1)); box-shadow: inset 0 0 0 1px rgba(34,211,238,.35)}

    .content{padding:22px; max-width:1200px; margin:0 auto; width:100%}
    .card{background: linear-gradient(180deg, rgba(148,163,184,.07), rgba(148,163,184,.03));
      border:1px solid rgba(148,163,184,.12); box-shadow: var(--shadow); border-radius: var(--radius); padding:20px; margin-bottom:20px;}
    h2{margin:0 0 8px; font-size:20px}
    p.lead{margin:0 0 12px; color:#c7d2fe}

    .grid{display:grid; grid-template-columns:1fr 1fr; gap:16px}
    .plot{min-height:420px; border-radius:14px; background:var(--card); border:1px solid rgba(148,163,184,.12); padding:8px}

    .matrix{display:grid; grid-template-columns:repeat(3, 90px); gap:8px; margin:10px 0 6px;}
    .matrix input{width:100%; padding:10px 8px; border-radius:10px; border:1px solid rgba(148,163,184,.25);
      background:rgba(2,8,23,.4); color:var(--text); outline:none;}
    .actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn{background:linear-gradient(180deg, rgba(34,211,238,.28), rgba(34,211,238,.12));
      border:1px solid rgba(34,211,238,.45); color:var(--text); font-weight:700; padding:10px 14px; border-radius:12px; cursor:pointer;}
    .btn.secondary{background:transparent; border:1px solid rgba(148,163,184,.3)}
    pre, code{background:rgba(2,8,23,.55); border:1px solid rgba(148,163,184,.18); border-radius:12px; padding:12px; overflow:auto; color:#d1fae5}

    .tab{display:none}
    .tab.active{display:block}

    @media (max-width: 1040px){ .grid{grid-template-columns:1fr} .sidebar{display:none} .content{padding:18px} }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs><linearGradient id="g" x1="0" x2="1" y1="0" y2="1">
          <stop stop-color="#22d3ee"/><stop offset="1" stop-color="#38bdf8"/></linearGradient></defs>
        <circle cx="32" cy="32" r="28" stroke="url(#g)" stroke-width="3"/>
        <path d="M18 36c10-2 18-10 28-8M20 44c8-4 16-4 24-2" stroke="url(#g)" stroke-width="3" stroke-linecap="round"/>
      </svg>
      <h1>Analytics Playground</h1>
    </div>
    <p class="subtle">Interactive demos: PyScript & Plotly</p>

    <div class="side-group">
      <div class="side-title">Sections</div>
      <a href="#" class="side-link" onclick="openTab('js')">JavaScript Demos <span class="pill">2D + 3D</span></a>
      <a href="#" class="side-link" onclick="openTab('py')">Python Demos <span class="pill">Matrix + Plot</span></a>
    </div>
  </aside>

  <!-- Main -->
  <div class="container">
    <header class="topbar">
      <div class="top-wrap">
        <div style="display:flex;align-items:center;gap:10px">
          <span style="font-weight:800;letter-spacing:.12em;color:#9bdff3">NUNO • DEMOS</span>
        </div>
        <nav class="menu" role="tablist" aria-label="Subpages">
          <button id="btn-js" class="active" onclick="openTab('js')" aria-controls="tab-js" aria-selected="true">JavaScript</button>
          <button id="btn-py" onclick="openTab('py')" aria-controls="tab-py" aria-selected="false">Python</button>
        </nav>
      </div>
    </header>

    <main class="content">
      <!-- JS TAB -->
      <section id="tab-js" class="tab active" role="tabpanel" aria-labelledby="btn-js">
        <div class="card">
          <h2>JavaScript Examples (Plotly)</h2>
          <p class="lead">Interactive 2D and 3D plots rendered entirely in the browser.</p>
        </div>

        <div class="grid">
          <div class="card">
            <h3 style="margin:0 0 10px">2D Line Chart: sin(x), cos(x)</h3>
            <div id="js-plot-2d" class="plot" aria-label="2D Plot"></div>
          </div>

          <div class="card">
            <h3 style="margin:0 0 10px">3D Surface: z = sin(x)·cos(y)</h3>
            <div id="js-plot-3d" class="plot" aria-label="3D Plot"></div>
          </div>
        </div>
      </section>

      <!-- PY TAB -->
      <section id="tab-py" class="tab" role="tabpanel" aria-labelledby="btn-py">
        <div class="card">
          <h2>Python Examples (PyScript)</h2>
          <p class="lead">Run Python in-browser: invert a 3×3 matrix and draw a Matplotlib plot.</p>
        </div>

        <div class="grid">
          <div class="card">
            <h3 style="margin:0 0 10px">3×3 Matrix Inversion</h3>
            <p class="subtle" style="margin:0 0 6px">Enter values and click <strong>Invert</strong>. Uses <code>numpy.linalg.inv</code>.</p>
            <div class="matrix">
              <input id="a11" type="number" value="1" step="any" />
              <input id="a12" type="number" value="2" step="any" />
              <input id="a13" type="number" value="3" step="any" />
              <input id="a21" type="number" value="0" step="any" />
              <input id="a22" type="number" value="1" step="any" />
              <input id="a23" type="number" value="4" step="any" />
              <input id="a31" type="number" value="5" step="any" />
              <input id="a32" type="number" value="6" step="any" />
              <input id="a33" type="number" value="0" step="any" />
            </div>
            <div class="actions">
              <!-- call Python via PyScript runtime -->
              <button class="btn" onclick="pyscript.runtime.globals.get('invert_matrix')()">Invert</button>
              <button class="btn secondary" onclick="pyscript.runtime.globals.get('reset_matrix')()">Reset</button>
            </div>
            <div style="height:10px"></div>
            <div id="py-matrix-output"></div>
          </div>

          <div class="card">
            <h3 style="margin:0 0 10px">Matplotlib Plot (Python)</h3>
            <div id="py-plot-out" class="plot"></div>
            <div id="py-meta" class="subtle" style="margin-top:10px"></div>
          </div>
        </div>

        <!-- PyScript: no pyscript.display usage -->
        <py-script>
import datetime, io, base64
import numpy as np, matplotlib.pyplot as plt
from js import document  # DOM access

IDS = ["a11","a12","a13","a21","a22","a23","a31","a32","a33"]
DEFAULTS = [1,2,3,0,1,4,5,6,0]

def _q(id_):
    el = document.getElementById(id_)
    if el is None:
        raise RuntimeError(f"Missing element: #{id_}")
    return el

def _read_matrix():
    vals = [float(_q(i).value) for i in IDS]
    return np.array(vals, dtype=float).reshape((3,3))

def _fmt(M, name):
    with np.printoptions(precision=4, suppress=True):
        return f"{name} =\n{M}\n"

def _pre(s: str) -> str:
    return f"<pre style='margin:0'>{s}</pre>"

def invert_matrix(event=None):
    try:
        A = _read_matrix()
        det = float(np.linalg.det(A))
        if abs(det) < 1e-12:
            _q("py-matrix-output").innerHTML = _pre("Matrix is singular (det≈0), cannot invert.")
            return
        Ainv = np.linalg.inv(A)
        I = A @ Ainv
        txt  = _fmt(A, "A")
        txt += f"det(A) = {det:.6f}\n\n"
        txt += _fmt(Ainv, "A⁻¹")
        txt += _fmt(I, "A·A⁻¹")
        _q("py-matrix-output").innerHTML = _pre(txt)
    except Exception as e:
        _q("py-matrix-output").innerHTML = _pre(f"Error: {e}")

def reset_matrix(event=None):
    for val, i in zip(DEFAULTS, IDS):
        _q(i).value = val
    invert_matrix()

def render_matplotlib_plot():
    x = np.linspace(0, 2*np.pi, 400)
    y = np.sin(x) * np.exp(-0.15*x)
    fig, ax = plt.subplots()
    ax.plot(x, y, linewidth=2)
    ax.set_title("Damped Sine (Matplotlib)")
    ax.set_xlabel("x"); ax.set_ylabel("sin(x)·e^{-0.15x}")
    ax.grid(True, alpha=.35)

    buf = io.BytesIO()
    fig.savefig(buf, format="png", bbox_inches="tight", dpi=144)
    plt.close(fig)
    buf.seek(0)
    b64 = base64.b64encode(buf.read()).decode("ascii")
    _q("py-plot-out").innerHTML = (
        f"<img alt='Matplotlib plot' style='width:100%;height:100%;object-fit:contain;border-radius:10px'"
        f" src='data:image/png;base64,{b64}'/>"
    )

def init_page():
    _q("py-meta").innerHTML = f"Python initialized at: <code>{datetime.datetime.now():%Y-%m-%d %H:%M:%S}</code>"
    reset_matrix()
    render_matplotlib_plot()

# Run once elements exist (this block is after them in HTML)
init_page()
        </py-script>
      </section>
    </main>
  </div>

  <!-- JavaScript logic -->
  <script>
    // Tabs
    function openTab(which){
      const js = document.getElementById('tab-js');
      const py = document.getElementById('tab-py');
      const bjs = document.getElementById('btn-js');
      const bpy = document.getElementById('btn-py');
      if(which === 'js'){
        js.classList.add('active'); py.classList.remove('active');
        bjs.classList.add('active'); bpy.classList.remove('active');
      }else{
        py.classList.add('active'); js.classList.remove('active');
        bpy.classList.add('active'); bjs.classList.remove('active');
      }
    }

    // Plotly 2D: sin & cos
    function draw2D(){
      const N = 400, xs = [], ys = [], yc = [];
      for(let i=0;i<N;i++){
        const x = i*(2*Math.PI)/(N-1);
        xs.push(x); ys.push(Math.sin(x)); yc.push(Math.cos(x));
      }
      const data = [
        {x:xs, y:ys, mode:'lines', name:'sin(x)'},
        {x:xs, y:yc, mode:'lines', name:'cos(x)'}
      ];
      const layout = { title:'Sine & Cosine (Plotly 2D)', xaxis:{title:'x'}, yaxis:{title:'y'}, margin:{t:48, r:12, b:48, l:48} };
      Plotly.newPlot('js-plot-2d', data, layout, {responsive:true});
    }

    // Plotly 3D: z = sin(x)·cos(y)
    function draw3D(){
      const x = [], y = [];
      for(let i=0;i<=60;i++){ x.push(-3 + 6*i/60); y.push(-3 + 6*i/60); }
      const z = [];
      for(let i=0;i<x.length;i++){
        const row = [];
        for(let j=0; j<y.length; j++){
          const xx = x[i], yy = y[j];
          row.push(Math.sin(xx) * Math.cos(yy));
        }
        z.push(row);
      }
      const data = [{ type:'surface', x:x, y:y, z:z, contours:{ z:{show:true, usecolormap:true, highlightcolor:'white', project:{z:true}}}}];
      const layout = { title:'Surface z = sin(x)·cos(y) (Plotly 3D)', scene:{ xaxis:{title:'x'}, yaxis:{title:'y'}, zaxis:{title:'z'} }, margin:{l:0,r:0,b:0,t:48} };
      Plotly.newPlot('js-plot-3d', data, layout, {responsive:true});
    }

    // Initialize plots
    draw2D();
    draw3D();
  </script>
</body>
</html>
